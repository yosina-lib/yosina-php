<?php

declare(strict_types=1);

namespace Yosina\Transliterators;

use Yosina\Char;
use Yosina\TransliteratorInterface;

/**
 * Replace single characters with arrays of characters.
 */
class CombinedTransliterator implements TransliteratorInterface
{
    private const MAPPINGS = [
        '№' => ["N", "o"],
        '℠' => ["S", "M"],
        '℡' => ["T", "E", "L"],
        '™' => ["T", "M"],
        '℻' => ["F", "A", "X"],
        '⅐' => ["1", "/", "7"],
        '⅑' => ["1", "/", "9"],
        '⅒' => ["1", "/", "1", "0"],
        '⅓' => ["1", "/", "3"],
        '⅔' => ["2", "/", "3"],
        '⅕' => ["1", "/", "5"],
        '⅖' => ["2", "/", "5"],
        '⅗' => ["3", "/", "5"],
        '⅘' => ["4", "/", "5"],
        '⅙' => ["1", "/", "6"],
        '⅚' => ["5", "/", "6"],
        '⅛' => ["1", "/", "8"],
        '⅜' => ["3", "/", "8"],
        '⅝' => ["5", "/", "8"],
        '⅞' => ["7", "/", "8"],
        '⅟' => ["1", "/"],
        '↉' => ["0", "/", "3"],
        '␀' => ["N", "U", "L"],
        '␁' => ["S", "O", "H"],
        '␂' => ["S", "T", "X"],
        '␃' => ["E", "T", "X"],
        '␄' => ["E", "O", "T"],
        '␅' => ["E", "N", "Q"],
        '␆' => ["A", "C", "K"],
        '␇' => ["B", "E", "L"],
        '␈' => ["B", "S"],
        '␉' => ["H", "T"],
        '␊' => ["L", "F"],
        '␋' => ["V", "T"],
        '␌' => ["F", "F"],
        '␍' => ["C", "R"],
        '␎' => ["S", "O"],
        '␏' => ["S", "I"],
        '␐' => ["D", "L", "E"],
        '␑' => ["D", "C", "1"],
        '␒' => ["D", "C", "2"],
        '␓' => ["D", "C", "3"],
        '␔' => ["D", "C", "4"],
        '␕' => ["N", "A", "K"],
        '␖' => ["S", "Y", "N"],
        '␗' => ["E", "T", "B"],
        '␘' => ["C", "A", "N"],
        '␙' => ["E", "M"],
        '␚' => ["S", "U", "B"],
        '␛' => ["E", "S", "C"],
        '␜' => ["F", "S"],
        '␝' => ["G", "S"],
        '␞' => ["R", "S"],
        '␟' => ["U", "S"],
        '␠' => ["S", "P"],
        '␡' => ["D", "E", "L"],
        '⑴' => ["(", "1", ")"],
        '⑵' => ["(", "2", ")"],
        '⑶' => ["(", "3", ")"],
        '⑷' => ["(", "4", ")"],
        '⑸' => ["(", "5", ")"],
        '⑹' => ["(", "6", ")"],
        '⑺' => ["(", "7", ")"],
        '⑻' => ["(", "8", ")"],
        '⑼' => ["(", "9", ")"],
        '⑽' => ["(", "1", "0", ")"],
        '⑾' => ["(", "1", "1", ")"],
        '⑿' => ["(", "1", "2", ")"],
        '⒀' => ["(", "1", "3", ")"],
        '⒁' => ["(", "1", "4", ")"],
        '⒂' => ["(", "1", "5", ")"],
        '⒃' => ["(", "1", "6", ")"],
        '⒄' => ["(", "1", "7", ")"],
        '⒅' => ["(", "1", "8", ")"],
        '⒆' => ["(", "1", "9", ")"],
        '⒇' => ["(", "2", "0", ")"],
        '⒈' => ["1", "."],
        '⒉' => ["2", "."],
        '⒊' => ["3", "."],
        '⒋' => ["4", "."],
        '⒌' => ["5", "."],
        '⒍' => ["6", "."],
        '⒎' => ["7", "."],
        '⒏' => ["8", "."],
        '⒐' => ["9", "."],
        '⒑' => ["1", "0", "."],
        '⒒' => ["1", "1", "."],
        '⒓' => ["1", "2", "."],
        '⒔' => ["1", "3", "."],
        '⒕' => ["1", "4", "."],
        '⒖' => ["1", "5", "."],
        '⒗' => ["1", "6", "."],
        '⒘' => ["1", "7", "."],
        '⒙' => ["1", "8", "."],
        '⒚' => ["1", "9", "."],
        '⒛' => ["2", "0", "."],
        '⒜' => ["(", "a", ")"],
        '⒝' => ["(", "b", ")"],
        '⒞' => ["(", "c", ")"],
        '⒟' => ["(", "d", ")"],
        '⒠' => ["(", "e", ")"],
        '⒡' => ["(", "f", ")"],
        '⒢' => ["(", "g", ")"],
        '⒣' => ["(", "h", ")"],
        '⒤' => ["(", "i", ")"],
        '⒥' => ["(", "j", ")"],
        '⒦' => ["(", "k", ")"],
        '⒧' => ["(", "l", ")"],
        '⒨' => ["(", "m", ")"],
        '⒩' => ["(", "n", ")"],
        '⒪' => ["(", "o", ")"],
        '⒫' => ["(", "p", ")"],
        '⒬' => ["(", "q", ")"],
        '⒭' => ["(", "r", ")"],
        '⒮' => ["(", "s", ")"],
        '⒯' => ["(", "t", ")"],
        '⒰' => ["(", "u", ")"],
        '⒱' => ["(", "v", ")"],
        '⒲' => ["(", "w", ")"],
        '⒳' => ["(", "x", ")"],
        '⒴' => ["(", "y", ")"],
        '⒵' => ["(", "z", ")"],
        '㈠' => ["(", '一', ")"],
        '㈡' => ["(", '二', ")"],
        '㈢' => ["(", '三', ")"],
        '㈣' => ["(", '四', ")"],
        '㈤' => ["(", '五', ")"],
        '㈥' => ["(", '六', ")"],
        '㈦' => ["(", '七', ")"],
        '㈧' => ["(", '八', ")"],
        '㈨' => ["(", '九', ")"],
        '㈩' => ["(", '十', ")"],
        '㈪' => ["(", '月', ")"],
        '㈫' => ["(", '火', ")"],
        '㈬' => ["(", '水', ")"],
        '㈭' => ["(", '木', ")"],
        '㈮' => ["(", '金', ")"],
        '㈯' => ["(", '土', ")"],
        '㈰' => ["(", '日', ")"],
        '㈱' => ["(", '株', ")"],
        '㈲' => ["(", '有', ")"],
        '㈳' => ["(", '社', ")"],
        '㈴' => ["(", '名', ")"],
        '㈵' => ["(", '特', ")"],
        '㈶' => ["(", '財', ")"],
        '㈷' => ["(", '祝', ")"],
        '㈸' => ["(", '労', ")"],
        '㈹' => ["(", '代', ")"],
        '㈺' => ["(", '呼', ")"],
        '㈻' => ["(", '学', ")"],
        '㈼' => ["(", '監', ")"],
        '㈽' => ["(", '企', ")"],
        '㈾' => ["(", '資', ")"],
        '㈿' => ["(", '協', ")"],
        '㉀' => ["(", '祭', ")"],
        '㉁' => ["(", '休', ")"],
        '㉂' => ["(", '自', ")"],
        '㉃' => ["(", '至', ")"],
        '㉐' => ["P", "T", "E"],
        '㋀' => ["1", '月'],
        '㋁' => ["2", '月'],
        '㋂' => ["3", '月'],
        '㋃' => ["4", '月'],
        '㋄' => ["5", '月'],
        '㋅' => ["6", '月'],
        '㋆' => ["7", '月'],
        '㋇' => ["8", '月'],
        '㋈' => ["9", '月'],
        '㋉' => ["1", "0", '月'],
        '㋊' => ["1", "1", '月'],
        '㋋' => ["1", "2", '月'],
        '㋌' => ["H", "g"],
        '㋍' => ["e", "r", "g"],
        '㋎' => ["e", "V"],
        '㋏' => ["L", "T", "D"],
        '㋿' => ['令', '和'],
        '㌀' => ['ア', 'パ', 'ー', 'ト'],
        '㌁' => ['ア', 'ル', 'フ', 'ァ'],
        '㌂' => ['ア', 'ン', 'ペ', 'ア'],
        '㌃' => ['ア', 'ー', 'ル'],
        '㌄' => ['イ', 'ニ', 'ン', 'グ'],
        '㌅' => ['イ', 'ン', 'チ'],
        '㌆' => ['ウ', 'ォ', 'ン'],
        '㌇' => ['エ', 'ス', 'ク', 'ー', 'ド'],
        '㌈' => ['エ', 'ー', 'カ', 'ー'],
        '㌉' => ['オ', 'ン', 'ス'],
        '㌊' => ['オ', 'ー', 'ム'],
        '㌋' => ['カ', 'イ', 'リ'],
        '㌌' => ['カ', 'ラ', 'ッ', 'ト'],
        '㌍' => ['カ', 'ロ', 'リ', 'ー'],
        '㌎' => ['ガ', 'ロ', 'ン'],
        '㌏' => ['ガ', 'ン', 'マ'],
        '㌐' => ['ギ', 'ガ'],
        '㌑' => ['ギ', 'ニ', 'ー'],
        '㌒' => ['キ', 'ュ', 'リ', 'ー'],
        '㌓' => ['ギ', 'ル', 'ダ', 'ー'],
        '㌔' => ['キ', 'ロ'],
        '㌕' => ['キ', 'ロ', 'グ', 'ラ', 'ム'],
        '㌖' => ['キ', 'ロ', 'メ', 'ー', 'ト', 'ル'],
        '㌗' => ['キ', 'ロ', 'ワ', 'ッ', 'ト'],
        '㌘' => ['グ', 'ラ', 'ム'],
        '㌙' => ['グ', 'ラ', 'ム', 'ト', 'ン'],
        '㌚' => ['ク', 'ル', 'ゼ', 'イ', 'ロ'],
        '㌛' => ['ク', 'ロ', 'ー', 'ネ'],
        '㌜' => ['ケ', 'ー', 'ス'],
        '㌝' => ['コ', 'ル', 'ナ'],
        '㌞' => ['コ', 'ー', 'ポ'],
        '㌟' => ['サ', 'イ', 'ク', 'ル'],
        '㌠' => ['サ', 'ン', 'チ', 'ー', 'ム'],
        '㌡' => ['シ', 'リ', 'ン', 'グ'],
        '㌢' => ['セ', 'ン', 'チ'],
        '㌣' => ['セ', 'ン', 'ト'],
        '㌤' => ['ダ', 'ー', 'ス'],
        '㌥' => ['デ', 'シ'],
        '㌦' => ['ド', 'ル'],
        '㌧' => ['ト', 'ン'],
        '㌨' => ['ナ', 'ノ'],
        '㌩' => ['ノ', 'ッ', 'ト'],
        '㌪' => ['ハ', 'イ', 'ツ'],
        '㌫' => ['パ', 'ー', 'セ', 'ン', 'ト'],
        '㌬' => ['パ', 'ー', 'ツ'],
        '㌭' => ['バ', 'ー', 'レ', 'ル'],
        '㌮' => ['ピ', 'ア', 'ス', 'ト', 'ル'],
        '㌯' => ['ピ', 'ク', 'ル'],
        '㌰' => ['ピ', 'コ'],
        '㌱' => ['ビ', 'ル'],
        '㌲' => ['フ', 'ァ', 'ラ', 'ッ', 'ド'],
        '㌳' => ['フ', 'ィ', 'ー', 'ト'],
        '㌴' => ['ブ', 'ッ', 'シ', 'ェ', 'ル'],
        '㌵' => ['フ', 'ラ', 'ン'],
        '㌶' => ['ヘ', 'ク', 'タ', 'ー', 'ル'],
        '㌷' => ['ペ', 'ソ'],
        '㌸' => ['ペ', 'ニ', 'ヒ'],
        '㌹' => ['ヘ', 'ル', 'ツ'],
        '㌺' => ['ペ', 'ン', 'ス'],
        '㌻' => ['ペ', 'ー', 'ジ'],
        '㌼' => ['ベ', 'ー', 'タ'],
        '㌽' => ['ポ', 'イ', 'ン', 'ト'],
        '㌾' => ['ボ', 'ル', 'ト'],
        '㌿' => ['ホ', 'ン'],
        '㍀' => ['ポ', 'ン', 'ド'],
        '㍁' => ['ホ', 'ー', 'ル'],
        '㍂' => ['ホ', 'ー', 'ン'],
        '㍃' => ['マ', 'イ', 'ク', 'ロ'],
        '㍄' => ['マ', 'イ', 'ル'],
        '㍅' => ['マ', 'ッ', 'ハ'],
        '㍆' => ['マ', 'ル', 'ク'],
        '㍇' => ['マ', 'ン', 'シ', 'ョ', 'ン'],
        '㍈' => ['ミ', 'ク', 'ロ', 'ン'],
        '㍉' => ['ミ', 'リ'],
        '㍊' => ['ミ', 'リ', 'バ', 'ー', 'ル'],
        '㍋' => ['メ', 'ガ'],
        '㍌' => ['メ', 'ガ', 'ト', 'ン'],
        '㍍' => ['メ', 'ー', 'ト', 'ル'],
        '㍎' => ['ヤ', 'ー', 'ド'],
        '㍏' => ['ヤ', 'ー', 'ル'],
        '㍐' => ['ユ', 'ア', 'ン'],
        '㍑' => ['リ', 'ッ', 'ト', 'ル'],
        '㍒' => ['リ', 'ラ'],
        '㍓' => ['ル', 'ピ', 'ー'],
        '㍔' => ['ル', 'ー', 'ブ', 'ル'],
        '㍕' => ['レ', 'ム'],
        '㍖' => ['レ', 'ン', 'ト', 'ゲ', 'ン'],
        '㍗' => ['ワ', 'ッ', 'ト'],
        '㍘' => ["0", '点'],
        '㍙' => ["1", '点'],
        '㍚' => ["2", '点'],
        '㍛' => ["3", '点'],
        '㍜' => ["4", '点'],
        '㍝' => ["5", '点'],
        '㍞' => ["6", '点'],
        '㍟' => ["7", '点'],
        '㍠' => ["8", '点'],
        '㍡' => ["9", '点'],
        '㍢' => ["1", "0", '点'],
        '㍣' => ["1", "1", '点'],
        '㍤' => ["1", "2", '点'],
        '㍥' => ["1", "3", '点'],
        '㍦' => ["1", "4", '点'],
        '㍧' => ["1", "5", '点'],
        '㍨' => ["1", "6", '点'],
        '㍩' => ["1", "7", '点'],
        '㍪' => ["1", "8", '点'],
        '㍫' => ["1", "9", '点'],
        '㍬' => ["2", "0", '点'],
        '㍭' => ["2", "1", '点'],
        '㍮' => ["2", "2", '点'],
        '㍯' => ["2", "3", '点'],
        '㍰' => ["2", "4", '点'],
        '㍱' => ["h", "P", "a"],
        '㍲' => ["d", "a"],
        '㍳' => ["A", "U"],
        '㍴' => ["b", "a", "r"],
        '㍵' => ["o", "V"],
        '㍶' => ["p", "c"],
        '㍷' => ["d", "m"],
        '㍸' => ["d", "m", "2"],
        '㍹' => ["d", "m", "3"],
        '㍺' => ["I", "U"],
        '㍻' => ['平', '成'],
        '㍼' => ['昭', '和'],
        '㍽' => ['大', '正'],
        '㍾' => ['明', '治'],
        '㍿' => ['株', '式', '会', '社'],
        '㎀' => ["p", "A"],
        '㎁' => ["n", "A"],
        '㎂' => ['µ', "A"],
        '㎃' => ["m", "A"],
        '㎄' => ["k", "A"],
        '㎅' => ["K", "B"],
        '㎆' => ["M", "B"],
        '㎇' => ["G", "B"],
        '㎈' => ["c", "a", "l"],
        '㎉' => ["k", "c", "a", "l"],
        '㎊' => ["p", "F"],
        '㎋' => ["n", "F"],
        '㎌' => ['µ', "F"],
        '㎍' => ['µ', "g"],
        '㎎' => ["m", "g"],
        '㎏' => ["k", "g"],
        '㎐' => ["H", "z"],
        '㎑' => ["k", "H", "z"],
        '㎒' => ["M", "H", "z"],
        '㎓' => ["G", "H", "z"],
        '㎔' => ["T", "H", "z"],
        '㎕' => ['µ', "l"],
        '㎖' => ["m", "l"],
        '㎗' => ["d", "l"],
        '㎘' => ["k", "l"],
        '㎙' => ["f", "m"],
        '㎚' => ["n", "m"],
        '㎛' => ['µ', "m"],
        '㎜' => ["m", "m"],
        '㎝' => ["c", "m"],
        '㎞' => ["k", "m"],
        '㎟' => ["m", "m", "2"],
        '㎠' => ["c", "m", "2"],
        '㎡' => ["m", "2"],
        '㎢' => ["k", "m", "2"],
        '㎣' => ["m", "m", "3"],
        '㎤' => ["c", "m", "3"],
        '㎥' => ["m", "3"],
        '㎦' => ["k", "m", "3"],
        '㎧' => ["m", "/", "s"],
        '㎨' => ["m", "/", "s", "2"],
        '㎩' => ["P", "a"],
        '㎪' => ["k", "P", "a"],
        '㎫' => ["M", "P", "a"],
        '㎬' => ["G", "P", "a"],
        '㎭' => ["r", "a", "d"],
        '㎮' => ["r", "a", "d", "/", "s"],
        '㎯' => ["r", "a", "d", "/", "s", "2"],
        '㎰' => ["p", "s"],
        '㎱' => ["n", "s"],
        '㎲' => ['µ', "s"],
        '㎳' => ["m", "s"],
        '㎴' => ["p", "V"],
        '㎵' => ["n", "V"],
        '㎶' => ['µ', "V"],
        '㎷' => ["m", "V"],
        '㎸' => ["k", "V"],
        '㎹' => ["M", "V"],
        '㎺' => ["p", "W"],
        '㎻' => ["n", "W"],
        '㎼' => ['µ', "W"],
        '㎽' => ["m", "W"],
        '㎾' => ["k", "W"],
        '㎿' => ["M", "W"],
        '㏀' => ["k", 'Ω'],
        '㏁' => ["M", 'Ω'],
        '㏂' => ["a", ".", "m", "."],
        '㏃' => ["B", "q"],
        '㏄' => ["c", "c"],
        '㏅' => ["c", "d"],
        '㏆' => ["C", "/", "k", "g"],
        '㏇' => ["C", "o", "."],
        '㏈' => ["d", "B"],
        '㏉' => ["G", "y"],
        '㏊' => ["h", "a"],
        '㏋' => ["H", "P"],
        '㏌' => ["i", "n"],
        '㏍' => ["K", ".", "K", "."],
        '㏎' => ["K", "M"],
        '㏏' => ["k", "t"],
        '㏐' => ["l", "m"],
        '㏑' => ["l", "n"],
        '㏒' => ["l", "o", "g"],
        '㏓' => ["l", "x"],
        '㏔' => ["m", "b"],
        '㏕' => ["m", "i", "l"],
        '㏖' => ["m", "o", "l"],
        '㏗' => ["p", "H"],
        '㏘' => ["p", ".", "m", "."],
        '㏙' => ["p", "p", "m"],
        '㏚' => ["P", "R"],
        '㏛' => ["s", "r"],
        '㏜' => ["S", "v"],
        '㏝' => ["W", "b"],
        '㏞' => ["V", "/", "m"],
        '㏟' => ["A", "/", "m"],
        '㏠' => ["1", '日'],
        '㏡' => ["2", '日'],
        '㏢' => ["3", '日'],
        '㏣' => ["4", '日'],
        '㏤' => ["5", '日'],
        '㏥' => ["6", '日'],
        '㏦' => ["7", '日'],
        '㏧' => ["8", '日'],
        '㏨' => ["9", '日'],
        '㏩' => ["1", "0", '日'],
        '㏪' => ["1", "1", '日'],
        '㏫' => ["1", "2", '日'],
        '㏬' => ["1", "3", '日'],
        '㏭' => ["1", "4", '日'],
        '㏮' => ["1", "5", '日'],
        '㏯' => ["1", "6", '日'],
        '㏰' => ["1", "7", '日'],
        '㏱' => ["1", "8", '日'],
        '㏲' => ["1", "9", '日'],
        '㏳' => ["2", "0", '日'],
        '㏴' => ["2", "1", '日'],
        '㏵' => ["2", "2", '日'],
        '㏶' => ["2", "3", '日'],
        '㏷' => ["2", "4", '日'],
        '㏸' => ["2", "5", '日'],
        '㏹' => ["2", "6", '日'],
        '㏺' => ["2", "7", '日'],
        '㏻' => ["2", "8", '日'],
        '㏼' => ["2", "9", '日'],
        '㏽' => ["3", "0", '日'],
        '㏾' => ["3", "1", '日'],
        '㏿' => ["g", "a", "l"],
        '🄀' => ["0", "."],
        '🄁' => ["0", ","],
        '🄂' => ["1", ","],
        '🄃' => ["2", ","],
        '🄄' => ["3", ","],
        '🄅' => ["4", ","],
        '🄆' => ["5", ","],
        '🄇' => ["6", ","],
        '🄈' => ["7", ","],
        '🄉' => ["8", ","],
        '🄊' => ["9", ","],
        '🄐' => ["(", "A", ")"],
        '🄑' => ["(", "B", ")"],
        '🄒' => ["(", "C", ")"],
        '🄓' => ["(", "D", ")"],
        '🄔' => ["(", "E", ")"],
        '🄕' => ["(", "F", ")"],
        '🄖' => ["(", "G", ")"],
        '🄗' => ["(", "H", ")"],
        '🄘' => ["(", "I", ")"],
        '🄙' => ["(", "J", ")"],
        '🄚' => ["(", "K", ")"],
        '🄛' => ["(", "L", ")"],
        '🄜' => ["(", "M", ")"],
        '🄝' => ["(", "N", ")"],
        '🄞' => ["(", "O", ")"],
        '🄟' => ["(", "P", ")"],
        '🄠' => ["(", "Q", ")"],
        '🄡' => ["(", "R", ")"],
        '🄢' => ["(", "S", ")"],
        '🄣' => ["(", "T", ")"],
        '🄤' => ["(", "U", ")"],
        '🄥' => ["(", "V", ")"],
        '🄦' => ["(", "W", ")"],
        '🄧' => ["(", "X", ")"],
        '🄨' => ["(", "Y", ")"],
        '🄩' => ["(", "Z", ")"],
        '🄪' => ['〔', "S", '〕'],
        '🅪' => ["M", "C"],
        '🅫' => ["M", "D"],
        '🅬' => ["M", "R"],
        '🈀' => ['ほ', 'か'],
        '🉀' => ['〔', '本', '〕'],
        '🉁' => ['〔', '三', '〕'],
        '🉂' => ['〔', '二', '〕'],
        '🉃' => ['〔', '安', '〕'],
        '🉄' => ['〔', '点', '〕'],
        '🉅' => ['〔', '打', '〕'],
        '🉆' => ['〔', '盗', '〕'],
        '🉇' => ['〔', '勝', '〕'],
        '🉈' => ['〔', '敗', '〕'],
    ];

    /**
     * @param array<string, mixed> $options
     */
    public function __construct(/* @phpstan-ignore constructor.unusedParameter */ array $options = []) {}

    /**
     * @param iterable<Char> $inputChars
     * @return iterable<Char>
     */
    public function __invoke(iterable $inputChars): iterable
    {
        $offset = 0;
        foreach ($inputChars as $char) {
            $replacement = self::MAPPINGS[$char->c] ?? null;
            if ($replacement !== null && is_array($replacement)) {
                foreach ($replacement as $replacementChar) {
                    yield new Char($replacementChar, $offset, $char);
                    $offset += strlen($replacementChar);
                }
            } else {
                yield $char->withOffset($offset);
                $offset += strlen($char->c);
            }
        }
    }
}
